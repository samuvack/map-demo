<html lang = "en">

<head>
    <meta charset = "UTF-8" />
    <title>Leaflet Timeline Slider</title>
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
    integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
    integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
    crossorigin=""></script>

    <script src="src/leaflet-timeline-slider.js"></script>
    
</head>
    <body>
        <div id="mapid" style="height: 600px;">
        </div>


        <script type="text/javascript">
            data =  {"type": "FeatureCollection",
                        "features": [
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Januari",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        3.698805, 51.0269849,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Februari",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        3.9318616099817, 51.173102904346806,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Maart",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                         4.074628939149434,51.07177060193755,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "April",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -71.3489484,
                                        42.4603719,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Mei",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                    
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -71.2272,
                                        42.4473,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Juni",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -0.118092,
                                        51.509865,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Juli",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -70.2553259,
                                        43.661471,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Augustus",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -70.2553259,
                                        43.661471,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "September",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -70.2553259,
                                        43.661471,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "Oktober",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -70.2553259,
                                        43.661471,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "November",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -70.2553259,
                                        43.661471,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "December",
                                    "content": "Demo kaartapplicatie Vlaamse Smart Data Space"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        -70.2553259,
                                        43.661471,
                                        1
                                    ]
                                }
                            }
                        ]
                    }


            
            var mymap = L.map('mapid')
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(mymap);
            
            getDataAddMarkers = function( {label, value, map, exclamation} ) {
                map.eachLayer(function (layer) {
                        if (layer instanceof L.Marker) {
                            map.removeLayer(layer);
                        }
                });

                filteredData = data.features.filter(function (i, n) {
                    return i.properties.title===label;
                    });

                var markerArray = [];
                L.geoJson(filteredData, {
                    onEachFeature: function onEachFeature(feature, layer) {
                        content = `${exclamation} <br> ${feature.properties.content} <br> (${Math.round(value/6 * 100)}% done with story)`
                        var popup = L.popup().setContent(content);
                        layer.bindPopup(popup);
                        markerArray.push(layer);
                    }
                }).addTo(map);
                
                var markerGroup = L.featureGroup(markerArray);
                map.fitBounds(markerGroup.getBounds()).setZoom(12);
            };

            L.control.timelineSlider({
                timelineItems: ["Januari", "Februari", "Maart", "April", "Mei", "Juni", "Juli", "Augustus", "September", "Oktober", "November", "December"], 
                changeMap: getDataAddMarkers,
                extraChangeMapParams: {exclamation: "Hello World!"} })
            .addTo(mymap);             
        </script>
    </body>

</html>